<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Movie Cards - Netflix Clone</title>
    <style>
        body {
            background: #141414;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
        }
        .movie-card {
            display: inline-block;
            width: 200px;
            margin: 10px;
            background: #222;
            border-radius: 8px;
            overflow: hidden;
        }
        .movie-poster {
            width: 100%;
            height: 300px;
            object-fit: cover;
            background: #000;
        }
        .movie-info {
            padding: 10px;
        }
        .movie-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .movie-meta {
            font-size: 12px;
            color: #999;
        }
        .url-test {
            margin: 10px 0;
            padding: 10px;
            background: #333;
            border-radius: 4px;
        }
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #28a745; }
        .error { background: #dc3545; }
    </style>
</head>
<body>
    <h1>üé¨ Netflix Clone - Replacement Movie Cards Test</h1>
    
    <div class="debug-section">
        <h2>üîç Testing Specific Movies</h2>
        <div id="specific-movies"></div>
    </div>

    <div class="debug-section">
        <h2>üåê URL Testing</h2>
        <div id="url-tests"></div>
    </div>

    <script>
        // Test replacement movies with working poster URLs
        const testMovies = [
            {
                _id: "7",
                title: "Breaking Bad",
                poster_path: "/ggFHVNu6YYI5L9pCfOacjizRGt.jpg",
                posterUrl: "https://image.tmdb.org/t/p/w500/ggFHVNu6YYI5L9pCfOacjizRGt.jpg",
                rating: 9.5,
                releaseYear: 2008,
                genre: ["Crime", "Drama", "Thriller"]
            },
            {
                _id: "8",
                title: "House of Cards",
                poster_path: "/hKWxWjFwnMvkWQawbhvC0Y7ygQ8.jpg",
                posterUrl: "https://image.tmdb.org/t/p/w500/hKWxWjFwnMvkWQawbhvC0Y7ygQ8.jpg",
                rating: 8.7,
                releaseYear: 2013,
                genre: ["Drama", "Thriller"]
            },
            {
                _id: "11",
                title: "Narcos",
                poster_path: "/rTmal9fDbwh5F0waol2hq35U4ah.jpg",
                posterUrl: "https://image.tmdb.org/t/p/w500/rTmal9fDbwh5F0waol2hq35U4ah.jpg",
                rating: 8.8,
                releaseYear: 2015,
                genre: ["Biography", "Crime", "Drama"]
            },
            {
                _id: "12",
                title: "The Queen's Gambit",
                poster_path: "/zU0htwkhNvBQdVSIKB9s6hgVeFK.jpg",
                posterUrl: "https://image.tmdb.org/t/p/w500/zU0htwkhNvBQdVSIKB9s6hgVeFK.jpg",
                rating: 8.5,
                releaseYear: 2020,
                genre: ["Drama"]
            }
        ];

        function createMovieCard(movie) {
            const getFallbackImage = () => {
                return 'https://via.placeholder.com/300x450/000000/FFFFFF?text=No+Image';
            };
            
            let posterUrl;
            if (movie.poster_path && 
                movie.poster_path !== 'undefined' && 
                movie.poster_path !== 'null' && 
                movie.poster_path.trim() !== '') {
                posterUrl = `https://image.tmdb.org/t/p/w500${movie.poster_path}`;
            } else if (movie.posterUrl && 
                       movie.posterUrl !== 'undefined' && 
                       movie.posterUrl !== 'null' && 
                       movie.posterUrl.trim() !== '') {
                posterUrl = movie.posterUrl;
            } else {
                posterUrl = getFallbackImage();
            }
            
            const genre = Array.isArray(movie.genre) ? movie.genre.join(', ') : (movie.genre || 'Unknown');

            return `
                <div class="movie-card">
                    <img src="${posterUrl}" 
                         alt="${movie.title}" 
                         class="movie-poster"
                         onerror="this.onerror=null; this.src='https://via.placeholder.com/300x450/000000/FFFFFF?text=No+Image';">
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                        <div class="movie-meta">
                            <div>‚≠ê ${movie.rating}</div>
                            <div>${movie.releaseYear}</div>
                            <div>${genre}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Test URL accessibility
        function testImageUrl(url, title) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => resolve({ url, title, status: 'success' });
                img.onerror = () => resolve({ url, title, status: 'error' });
                img.src = url;
            });
        }

        // Render specific movies
        function renderSpecificMovies() {
            const container = document.getElementById('specific-movies');
            container.innerHTML = testMovies.map(movie => createMovieCard(movie)).join('');
        }

        // Test all URLs
        async function testAllUrls() {
            const container = document.getElementById('url-tests');
            const promises = testMovies.map(movie => 
                testImageUrl(`https://image.tmdb.org/t/p/w500${movie.poster_path}`, movie.title)
            );
            
            const results = await Promise.all(promises);
            
            container.innerHTML = results.map(result => `
                <div class="url-test">
                    <strong>${result.title}</strong><br>
                    <code>${result.url}</code><br>
                    <span class="status ${result.status}">${result.status.toUpperCase()}</span>
                </div>
            `).join('');
        }

        // Test API endpoints
        async function testApiEndpoints() {
            try {
                console.log('üîç Testing API endpoints...');
                
                const endpoints = [
                    'http://localhost:5000/api/health',
                    'http://localhost:5000/api/movies/trending',
                    'http://localhost:5000/api/movies/popular'
                ];
                
                for (const endpoint of endpoints) {
                    try {
                        const response = await fetch(endpoint);
                        const data = await response.json();
                        console.log(`‚úÖ ${endpoint}:`, data);
                    } catch (error) {
                        console.error(`‚ùå ${endpoint}:`, error.message);
                    }
                }
            } catch (error) {
                console.error('API test failed:', error);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderSpecificMovies();
            testAllUrls();
            testApiEndpoints();
        });
    </script>
</body>
</html>
